{# pandora_pm/app/templates/_macros.html #}

{# --- Form Field Rendering Macro --- #}
{# Basic macro to render a form field with label and potential errors (more useful with Flask-WTF) #}
{% macro render_field(field, label_visible=true) %}
  <div class="mb-3">
    {% if label_visible and field.label %}
      {{ field.label(class="form-label") }}
    {% endif %}

    {# Add is-invalid class if errors exist (for Bootstrap styling) #}
    {% set field_class = 'form-control is-invalid' if field.errors else 'form-control' %}

    {% if field.type == 'TextAreaField' %}
        {{ field(class=field_class, rows=3, **kwargs) }}
    {% elif field.type == 'BooleanField' %}
        <div class="form-check">
             {{ field(class='form-check-input', **kwargs) }}
             {{ field.label(class='form-check-label') }}
        </div>
    {% elif field.type == 'SelectField' %}
         {{ field(class='form-select', **kwargs) }}
    {% else %}
        {{ field(class=field_class, **kwargs) }}
    {% endif %}

    {% if field.errors %}
      <div class="invalid-feedback">
        {% for error in field.errors %}
          <span>{{ error }}</span><br>
        {% endfor %}
      </div>
    {% endif %}
  </div>
{% endmacro %}


{# --- Button Macro --- #}
{% macro pandora_button(text, url=None, type='primary', size='md', button_type='button', icon=None, extra_classes='') %}
  {% set btn_class = 'btn' %}
  {% if type == 'primary' %}
    {% set btn_class = btn_class ~ ' btn-pandora' %}
  {% elif type == 'secondary' %}
    {% set btn_class = btn_class ~ ' btn-pandora-secondary' %}
  {% elif type == 'danger' %}
    {% set btn_class = btn_class ~ ' btn-pandora-danger' %}
  {% else %}
    {% set btn_class = btn_class ~ ' btn-outline-light' %} {# Default fallback #}
  {% endif %}

  {% if size == 'sm' %}
    {% set btn_class = btn_class ~ ' btn-sm' %}
  {% elif size == 'lg' %}
    {% set btn_class = btn_class ~ ' btn-lg' %}
  {% endif %}

  {% if extra_classes %}
     {% set btn_class = btn_class ~ ' ' ~ extra_classes %}
  {% endif %}

  {% if url %}
    <a href="{{ url }}" class="{{ btn_class }}">
        {% if icon %}<i class="bi bi-{{ icon }} me-1"></i>{% endif %}{{ text }}
    </a>
  {% else %}
    <button type="{{ button_type }}" class="{{ btn_class }}">
        {% if icon %}<i class="bi bi-{{ icon }} me-1"></i>{% endif %}{{ text }}
    </button>
  {% endif %}
{% endmacro %}

{# You can add more macros here for things like:
   - Rendering pagination
   - Displaying user avatars
   - Formatting dates/times consistently
   - Generating specific card layouts
#}