{% extends "base.html" %}

{% block content %}
<h1 class="mb-4 form-title-pandora">{{ title }}</h1>

<form method="POST" action="" novalidate> {# Action URL set dynamically by route #}
    {# Add CSRF token here if using Flask-WTF #}

    <div class="mb-3">
        <label for="name" class="form-label">Project Name</label>
        <input type="text" class="form-control form-control-pandora" id="name" name="name" required
               value="{{ request.form['name'] if request.form['name'] is defined else (project.name if project else '') }}">
        <div class="invalid-feedback">Project name is required.</div>
    </div>

    <div class="mb-3">
        <label for="description" class="form-label">Description</label>
        <textarea class="form-control form-control-pandora" id="description" name="description" rows="4">{{ request.form['description'] if request.form['description'] is defined else (project.description if project else '') }}</textarea>
    </div>

    {% if project %} {# Show status only when editing #}
    <div class="mb-3">
         <label for="status" class="form-label">Status</label>
         <select class="form-select form-control-pandora" id="status" name="status">
             {% set current_status = request.form['status'] if request.form['status'] is defined else project.status %}
             {% for status_option in possible_statuses %}
                <option value="{{ status_option }}" {{ 'selected' if status_option == current_status else '' }}>
                    {{ status_option }}
                </option>
             {% endfor %}
        </select>
    </div>
    {% endif %}

    <div class="mb-3">
        <label for="due_date" class="form-label">Due Date (Optional)</label>
        <input type="date" class="form-control form-control-pandora" id="due_date" name="due_date"
               value="{{ request.form['due_date'] if request.form['due_date'] is defined else (project.due_date_str if project else '') }}">
         <div class="form-text">Format: YYYY-MM-DD</div>
    </div>

    <div class="mt-4">
        <button type="submit" class="btn btn-pandora me-2">
            {{ 'Update Project' if project else 'Create Project' }}
        </button>
        <a href="{{ url_for('projects.project_detail', project_id=project._id) if project else url_for('projects.project_list') }}" class="btn btn-pandora-secondary">
            Cancel
        </a>
    </div>
</form>
{% endblock %}